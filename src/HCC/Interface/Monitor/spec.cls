Class HCC.Interface.Monitor.spec Extends %REST.Spec [ ProcedureBlock ]
{

XData OpenAPI [ MimeType = application/json ]
{
{
  "swagger":"2.0",
  "info":{
    "title":"hcc api",
    "version":"1.0.0",
    "description":"HealthConnect消息及服务的一些统计示例"
  },
  "basePath":"/hcc/monitor",
  "consumes":[
    "application/x-www-form-urlencoded",
    "multipart/form-data"
  ],
  "schemes":[
    "http",
    "https"
  ],
  "paths":{
    "/services":{
      "get":{
        "summary":"获取所有命名空间的服务列表",
        "description":"服务列表",
        "tags":[
          "服务列表"
        ],
        "operationId":"getServices",
        "responses":{
          "200":{
            "description":"OK",
            "schema":{
              "$ref":"#/definitions/services"
            }
          },
          "500":{
            "$ref":"#/responses/Standard500ErrorResponse"
          }
        }
      }
    },
    "/{namespace}/services":{
      "get":{
        "summary":"获取单一命名空间的服务列表",
        "description":"关于什么是服务暂时定义为：1. running production里的BS,2. REST服务，没在produciton中的SOAP暂时不考虑。输出为service名字，类型(BS或者REST),如果是REST打印url",
        "tags":[
          "服务列表"
        ],
        "operationId":"getOneNamespaceServices",
        "parameters":[
          {
            "$ref":"#/parameters/namespace"
          }
        ],
        "responses":{
          "200":{
            "description":"OK",
            "schema":{
              "$ref":"#/definitions/services"
            }
          },
          "500":{
            "$ref":"#/responses/Standard500ErrorResponse"
          }
        }
      }
    },
    "/{namespace}/hosts":{
      "get":{
        "summary":"业务组件信息",
        "description":"获取单一命名空间正在运行的production的业务组件信息",
        "tags":[
          "业务组件信息"
        ],
        "operationId":"getBusinessHostInfo",
        "parameters":[
          {
            "$ref":"#/parameters/namespace"
          }
        ],
        "responses":{
          "200":{
            "description":"running businesshosts info",
            "schema":{
              "type":"array",
              "items":{
                "properties":{
                  "entry":{
                    "type":"string",
                    "maxLength":500
                  }
                }
              }
            }
          },
          "500":{
            "$ref":"#/responses/Standard500ErrorResponse"
          }
        }
      }
    },
    "/{namespace}/activitydata":{
      "get":{
        "summary":"业务量统计",
        "description":"统计最近一个小时内的各个组件的消息计数，或者当给定时间间隔，统计时间间隔内的消息计算",
        "tags":[
          "业务量统计"
        ],
        "operationId":"getActivityData",
        "parameters":[
          {
            "$ref":"#/parameters/namespace"
          },
          {
            "$ref":"#/parameters/beginTime"
          },
          {
            "$ref":"#/parameters/endTime"
          }
        ],
        "responses":{
          "200":{
            "$ref":"#/responses/activityDataResponse"
          },
          "500":{
            "$ref":"#/responses/Standard500ErrorResponse"
          }
        }
      }
    },
    "/{namespace}/eventLog":{
      "get":{
        "summary":"Event Log列表",
        "description":"通过level参数返回所有的entry或者只返回warning以上级别的记录",
        "tags":[
          "日志和警告"
        ],
        "operationId":"getEventLog",
        "parameters":[
          {
            "name":"namespace",
            "in":"path",
            "required":true,
            "type":"string"
          },
          {
            "name":"level",
            "in":"query",
            "required":false,
            "type":"string",
            "enum":[
              "all",
              "error"
            ]
          },
          {
            "$ref":"#/parameters/beginTime"
          },
          {
            "$ref":"#/parameters/endTime"
          }
        ],
        "responses":{
          "200":{
            "description":"返回EventLog列表",
            "schema":{
              "$ref":"#/definitions/businesshosts"
            }
          },
          "500":{
            "$ref":"#/responses/Standard500ErrorResponse"
          }
        }
      }
    }
  },
  "definitions":{
    "service":{
      "required":[
        "name",
        "type"
      ],
      "properties":{
        "name":{
          "type":"string"
        },
        "type":{
          "type":"string"
        },
        "url":{
          "type":"string"
        }
      }
    },
    "services":{
      "type":"array",
      "items":{
        "$ref":"#/definitions/service"
      }
    },
    "error":{
      "properties":{
        "code":{
          "type":"string"
        },
        "message":{
          "type":"string"
        }
      }
    },
    "businesshost":{
      "required":[
        "configName",
        "businesshostType"
      ],
      "properties":{
        "configName":{
          "type":"string"
        },
        "businesshostType":{
          "type":"string",
          "enum":[
            "BS",
            "BP",
            "BO"
          ]
        },
        "businesshostStatus":{
          "type":"string"
        }
      }
    },
    "businesshosts":{
      "type":"array",
      "items":{
        "$ref":"#/definitions/businesshost"
      }
    }
  },
  "responses":{
    "Standard500ErrorResponse":{
      "description":"标准500错误响应",
      "schema":{
        "$ref":"#/definitions/error"
      }
    },
    "activityDataResponse":{
      "description":"activityData的响应消息",
      "schema":{
        "properties":{
          "hostname":{
            "type":"string"
          },
          "totalCount":{
            "type":"integer"
          }
        }
      }
    }
  },
  "parameters":{
    "namespace":{
      "name":"namespace",
      "in":"path",
      "required":true,
      "type":"string"
    },
    "pageSize":{
      "name":"pageSize",
      "in":"query",
      "description":"单页返回的记录数量",
      "type":"string"
    },
    "pageNumber":{
      "name":"pageNumber",
      "in":"query",
      "description":"Page Number",
      "type":"integer"
    },
    "beginTime":{
      "name":"beginTime",
      "in":"formData",
      "description":"begin time",
      "type":"string",
      "format":"dateTime"
    },
    "endTime":{
      "name":"endTime",
      "in":"formData",
      "description":"end time",
      "type":"string",
      "format":"dateTime"
    }
  }
}
}

}
